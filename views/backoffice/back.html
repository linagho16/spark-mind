<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SparkMind - Back Office | Gestion ComplÃ¨te</title>
    <link rel="stylesheet" href="back.css">
    <script src="back.js" defer></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <img src="logo.png" alt="SparkMind Logo" class="sidebar-logo">
            <h2>SparkMind</h2>
            <p class="admin-role">Administrateur</p>
        </div>

        <nav class="sidebar-nav">
            <a href="#demandes" class="nav-item active" onclick="showSection(event, 'demandes')">
                <span class="nav-icon">ğŸ“Š</span>
                <span>Demandes d'aide</span>
                <span class="badge" id="badgeEnAttente">0</span>
            </a>
            <a href="#categories" class="nav-item" onclick="showSection(event, 'categories')">
                <span class="nav-icon">ğŸ“</span>
                <span>CatÃ©gories d'aide</span>
            </a>
            <a href="#gouvernorats" class="nav-item" onclick="showSection(event, 'gouvernorats')">
                <span class="nav-icon">ğŸ—ºï¸</span>
                <span>Par Gouvernorat</span>
            </a>
            <a href="#evolution" class="nav-item" onclick="showSection(event, 'evolution')">
                <span class="nav-icon">ğŸ“ˆ</span>
                <span>Ã‰volution</span>
            </a>
            <a href="#" class="nav-item logout">
                <span class="nav-icon">ğŸšª</span>
                <span>DÃ©connexion</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- ========================================
             SECTION 1: DEMANDES D'AIDE
             ======================================== -->
        <section id="section-demandes" class="content-section active">
            <!-- Top Bar -->
            <div class="top-bar">
                <h1>Gestion des Demandes d'Aide</h1>
                <div class="top-bar-actions">
                    <div class="search-box">
                        <input type="text" id="searchDemandes" placeholder="Rechercher une demande...">
                        <span class="search-icon">ğŸ”</span>
                    </div>
                    <div class="user-profile">
                        <span class="user-name">Admin</span>
                        <div class="user-avatar">A</div>
                    </div>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div class="stats-container">
                <div class="stat-card urgent">
                    <div class="stat-icon">ğŸ”´</div>
                    <div class="stat-info">
                        <h3 id="statUrgentes">0</h3>
                        <p>Demandes urgentes</p>
                    </div>
                </div>
                <div class="stat-card pending">
                    <div class="stat-icon">â³</div>
                    <div class="stat-info">
                        <h3 id="statEnAttente">0</h3>
                        <p>En attente</p>
                    </div>
                </div>
                <div class="stat-card processed">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-info">
                        <h3 id="statTraitees">0</h3>
                        <p>TraitÃ©es</p>
                    </div>
                </div>
                <div class="stat-card total">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-info">
                        <h3 id="statTotal">0</h3>
                        <p>Total</p>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters-section">
                <div class="filter-group">
                    <label>Statut:</label>
                    <select class="filter-select" id="filterStatut">
                        <option value="">Tous</option>
                        <option value="nouveau">Nouveau</option>
                        <option value="en-cours">En cours</option>
                        <option value="traite">TraitÃ©</option>
                        <option value="refuse">RefusÃ©</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Urgence:</label>
                    <select class="filter-select" id="filterUrgence">
                        <option value="">Toutes</option>
                        <option value="tres-urgent">TrÃ¨s urgent</option>
                        <option value="urgent">Urgent</option>
                        <option value="important">Important</option>
                        <option value="peut-attendre">Peut attendre</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Gouvernorat:</label>
                    <select class="filter-select" id="filterGouvernorat">
                        <option value="">Tous</option>
                    </select>
                </div>
                <button class="btn-filter" onclick="applyFilters()">Filtrer</button>
                <button class="btn-reset" onclick="resetFilters()">RÃ©initialiser</button>
            </div>

            <!-- Demandes Table -->
            <div class="table-container">
                <table class="demandes-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Nom</th>
                            <th>Gouvernorat</th>
                            <th>Type d'aide</th>
                            <th>Urgence</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="demandesTableBody">
                        <!-- DonnÃ©es dynamiques -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="paginationDemandes"></div>
        </section>

        <!-- ========================================
             SECTION 2: CATEGORIES D'AIDE
             ======================================== -->
        <section id="section-categories" class="content-section">
            <div class="top-bar">
                <h1>ğŸ“ Demandes par CatÃ©gorie d'Aide</h1>
                <button class="btn-add" onclick="loadDemandes()">ğŸ”„ Actualiser</button>
            </div>

            <div class="stats-container" id="categoriesStats">
                <!-- Statistiques par catÃ©gorie -->
            </div>

            <div class="table-container">
                <table class="categories-table">
                    <thead>
                        <tr>
                            <th>CatÃ©gorie</th>
                            <th>Nombre de demandes</th>
                            <th>Urgentes</th>
                            <th>En attente</th>
                            <th>TraitÃ©es</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="categoriesTableBody">
                        <!-- DonnÃ©es dynamiques -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ========================================
             SECTION 3: PAR GOUVERNORAT
             ======================================== -->
        <section id="section-gouvernorats" class="content-section">
            <div class="top-bar">
                <h1>ğŸ—ºï¸ Demandes par Gouvernorat</h1>
                <button class="btn-add" onclick="loadDemandes()">ğŸ”„ Actualiser</button>
            </div>

            <div class="table-container">
                <table class="gouvernorats-table">
                    <thead>
                        <tr>
                            <th>Gouvernorat</th>
                            <th>Nombre de demandes</th>
                            <th>Urgentes</th>
                            <th>En attente</th>
                            <th>TraitÃ©es</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="gouvernoratsTableBody">
                        <!-- DonnÃ©es dynamiques -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ========================================
             SECTION 4: Ã‰VOLUTION
             ======================================== -->
        <section id="section-evolution" class="content-section">
            <div class="top-bar">
                <h1>ğŸ“ˆ Ã‰volution des Demandes</h1>
                <button class="btn-add" onclick="loadDemandes()">ğŸ”„ Actualiser</button>
            </div>

            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“…</div>
                    <div class="stat-info">
                        <h3 id="statAujourdhui">0</h3>
                        <p>Aujourd'hui</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“†</div>
                    <div class="stat-info">
                        <h3 id="statSemaine">0</h3>
                        <p>Cette semaine</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-info">
                        <h3 id="statMois">0</h3>
                        <p>Ce mois</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¯</div>
                    <div class="stat-info">
                        <h3 id="statMoyenne">0</h3>
                        <p>Moyenne / jour</p>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Demandes par mois (6 derniers mois)</h3>
                <div id="evolutionChart" class="evolution-chart">
                    <!-- Graphique simple en barres -->
                </div>
            </div>
        </section>
    </div>

    <!-- Modal Modification Statut - NOUVEAU -->
    <div class="modal" id="statusModal">
        <div class="modal-content status-modal-content">
            <div class="modal-header">
                <h2>âœï¸ Modifier le Statut</h2>
                <button class="modal-close" onclick="closeModal('statusModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: #666;">
                    SÃ©lectionnez le nouveau statut pour la demande <strong>#<span id="currentDemandeId">-</span></strong>
                </p>
                
                <div class="status-options">
                    <div class="status-option nouveau" onclick="selectStatus(this, 'nouveau')">
                        <div class="status-option-icon">ğŸ†•</div>
                        <div class="status-option-content">
                            <div class="status-option-title">Nouveau</div>
                            <div class="status-option-description">La demande vient d'Ãªtre reÃ§ue et n'a pas encore Ã©tÃ© examinÃ©e</div>
                        </div>
                        <div class="status-option-check">âœ“</div>
                    </div>

                    <div class="status-option en-cours" onclick="selectStatus(this, 'en-cours')">
                        <div class="status-option-icon">â³</div>
                        <div class="status-option-content">
                            <div class="status-option-title">En cours</div>
                            <div class="status-option-description">La demande est en cours de traitement par notre Ã©quipe</div>
                        </div>
                        <div class="status-option-check">âœ“</div>
                    </div>

                    <div class="status-option traite" onclick="selectStatus(this, 'traite')">
                        <div class="status-option-icon">âœ…</div>
                        <div class="status-option-content">
                            <div class="status-option-title">TraitÃ©</div>
                            <div class="status-option-description">La demande a Ã©tÃ© complÃ¨tement traitÃ©e et rÃ©solue</div>
                        </div>
                        <div class="status-option-check">âœ“</div>
                    </div>

                    <div class="status-option refuse" onclick="selectStatus(this, 'refuse')">
                        <div class="status-option-icon">âŒ</div>
                        <div class="status-option-content">
                            <div class="status-option-title">RefusÃ©</div>
                            <div class="status-option-description">La demande ne peut pas Ãªtre acceptÃ©e pour le moment</div>
                        </div>
                        <div class="status-option-check">âœ“</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal cancel" onclick="closeModal('statusModal')">Annuler</button>
                <button class="btn-modal confirm" id="confirmStatusBtn" onclick="confirmStatusChange()" disabled>
                    Confirmer le changement
                </button>
            </div>
        </div>
    </div>

    <!-- Modal DÃ©tails Demande -->
    <div class="modal" id="detailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">DÃ©tails de la Demande</h2>
                <button class="modal-close" onclick="closeModal('detailsModal')">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Contenu dynamique -->
            </div>
        </div>
    </div>
</body>
</html>